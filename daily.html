<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Daily Undertaking - Today's Edition</title>
    <meta
      name="description"
      content="Your source for adventures and peculiar happenings from the Bureau of Undertakings"
    />

    <link rel="stylesheet" href="css/fonts.css" />
    <link rel="stylesheet" href="css/shared-base.css" />
    <link rel="stylesheet" href="css/daily.layout.css" />
    <link rel="stylesheet" href="css/daily.theme.css" />
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <header>
        <div class="masthead-top">
          <div class="edition-info">Today's Edition</div>
          <h1 class="masthead-title">The Daily Undertaking</h1>
          <div>
            <div class="free-stamp">FREE!</div>
            <div class="edition-info">YESTERDAY, REFILED</div>
          </div>
        </div>

        <div class="meta-bar">
          <div class="meta-section">
            <span>Vol. IV, No. 82</span>
            <button
              type="button"
              class="auth-button auth-login"
              id="openDailyLoginBtn"
              aria-label="Login to your account"
            >
              <span class="auth-button-text">Registry</span>
            </button>
          </div>
          <span class="meta-center">A Record of Proceedings and Consequences - Est. 2025</span>
          <div class="meta-section">
            <button
              type="button"
              class="auth-button auth-register"
              id="openDailyRegisterBtn"
              aria-label="Create a new account"
            >
              <span class="auth-button-text">Enroll</span>
            </button>
            <span>Price: One Copper</span>
          </div>
        </div>
      </header>

      <!-- Main Headline -->
      <section class="headline-section">
        <div class="kicker">The UU Commit to Pipeworks Project...</div>
        <h2 class="main-headline">Undermine Undertakers OnBoard!</h2>
      </section>

      <!-- Content Grid -->
      <div class="content-grid">
        <!-- Main Article (Left) -->
        <main class="article-column">
          <article>
            <div class="deck">
              A long-term effort to record what goes wrong, and why it mattered
            </div>
            <div class="byline">By Murnel Thatchwick, Staff Correspondent</div>

            <p>
              <span class="drop-cap">T</span>he Undermine Undertakers confirmed this week that they
              have formally committed to the Pipeworks Project, an ongoing effort to document
              practical failures, near-misses, misunderstandings, and "things that seemed like a
              good idea at the time."
            </p>

            <p>
              The project, which will be maintained in ledger form and updated as circumstances
              allow, is not intended to prevent mistakes entirely. Instead, it aims to make them
              legible. "A failure that can be read is a failure that can be survived," said one
              Undertaker, speaking from behind a stack of damp papers that were, at one point,
              thought to be a map.
            </p>

            <!-- Floating Image 1 -->
            <div class="float-img-container float-right">
              <figure class="filed-illustration">
                <img
                  src="assets/images/characters/orrin_pike_sitting.png"
                  alt="Orrin Pike"
                  class="float-img"
                />
                <figcaption>Orrin Pike, Risk Warden of the UU</figcaption>
              </figure>
            </div>

            <p>
              Pipeworks began as a modest attempt to keep track of tools. It has since expanded to
              include misplaced assumptions, misaligned expectations, and several entries labelled
              only 'Do Not Repeat', underlined twice. Unlike previous initiatives, the Pipeworks
              Project does not seek to identify fault. No individual names will be recorded unless
              they insist. Responsibility, the Undertakers note, is often distributed unevenly and
              arrives late.
            </p>

            <p>
              Early trials of the system have already yielded results. A recurring issue involving a
              vibrating brass key was eventually traced not to enchantment, but to a table being
              slightly uneven. The key has been returned to service. The table has not.
            </p>

            <p>
              Importantly, the ledger includes space for what was learned, what was ignored, and
              what was quietly worked around. Several pages remain blank. These are not considered
              failures.
            </p>

            <blockquote class="pull-quote">
              "We expect to get this wrong," the statement continues. "What matters is that we
              remember how."
            </blockquote>

            <p>
              The Undertakers emphasised that Pipeworks is not a corrective programme, nor a
              disciplinary one. It is, instead, a record of honest work carried out under imperfect
              conditions, by people doing their best with partial information.
            </p>

            <p>
              Market observers have already noted a subtle shift in tone among participating crews.
              Errors are being reported earlier. Explanations are becoming shorter. Bells are being
              rung less often. The project is expected to continue indefinitely, or until it proves
              unnecessary. No timeline has been provided.
            </p>
          </article>
        </main>

        <!-- Sidebar (Right) -->
        <aside class="sidebar-column ledger">
          <div class="sidebar-header">
            <h2 class="sidebar-title">LEGERFALL DAILY</h2>
          </div>

          <!-- Notices -->
          <section>
            <h3 class="section-title">Notices (Unverified but Filed)</h3>
            <ul class="sidebar-list">
              <li>Item believed resolved has reappeared. Please stop resolving it.</li>
              <li>Reminder: bells are not substitutes for explanations.</li>
              <li>Whoever moved the bench has improved nothing.</li>
              <li>This is the final notice regarding the previous final notice.</li>
            </ul>
          </section>

          <div class="sidebar-separator"></div>

          <!-- Ledger Adjustments -->
          <section>
            <h3 class="section-title">LEDGER ADJUSTMENTS</h3>
            <ul class="sidebar-list">
              <li>Yesterday's total was correct for the wrong reasons.</li>
              <li>An apology is issued to the concept of "after lunch."</li>
              <li>The phrase "under control" has been withdrawn.</li>
            </ul>
          </section>

          <div class="sidebar-separator"></div>

          <!-- Small Misfortunes -->
          <section>
            <h3 class="section-title">SMALL MISFORTUNES</h3>
            <ul class="sidebar-list">
              <li>A clerk discovered their pen had been working better upside down.</li>
              <li>The north stair now leads to the south. Temporarily.</li>
              <li>A meeting concluded successfully, though no one attended.</li>
            </ul>
          </section>

          <div class="sidebar-separator"></div>

          <!-- Found / Misplaced -->
          <section>
            <h3 class="section-title">FOUND / MISPLACED</h3>
            <ul class="sidebar-list">
              <li><span>Found:</span> One brass washer. Warm.</li>
              <li><span>Misplaced:</span> Confidence in the west conduit.</li>
              <li><span>Returned:</span> A key, having learned nothing.</li>
            </ul>
          </section>

          <div class="sidebar-separator"></div>

          <!-- Market & Provisions -->
          <section>
            <h3 class="section-title">MARKET & PROVISIONS</h3>
            <ul class="sidebar-list">
              <li>Root vegetables: present</li>
              <li>Cloth: thinner than advertised</li>
              <li>Advice: plentiful</li>
              <li>Guarantees: withdrawn</li>
            </ul>
          </section>

          <div class="sidebar-separator"></div>

          <!-- Weather -->
          <section>
            <h3 class="section-title">WEATHER (Filed Late)</h3>
            <ul class="sidebar-list">
              <li>Morning: Damp, unresolved</li>
              <li>Afternoon: Wind with intent</li>
              <li>Evening: Bell-related</li>
            </ul>
          </section>

          <div class="sidebar-separator"></div>

          <!-- Tomorrow -->
          <section>
            <h3 class="section-title">TOMORROW'S UNDERTAKING</h3>
            <ul class="sidebar-list">
              <li>Further clarification expected.</li>
              <li>Delays anticipated.</li>
              <li>Normal service unlikely.</li>
            </ul>
          </section>
        </aside>
      </div>

      <!-- Tabbed Reference Block (Full Width) -->
      <section class="reference-block tabbed-section">
        <!-- Tab Navigation -->
        <div class="tabs-nav">
          <button class="tab-button active" data-tab="tab-1">Notable Mis-Adventures</button>
          <button class="tab-button" data-tab="tab-2">Ledger Entries</button>
          <button class="tab-button" data-tab="tab-3">Filed Reports</button>
          <button class="tab-button" data-tab="tab-4">Pipeworks Status</button>
        </div>

        <!-- Tab Content -->
        <div class="tabs-content">
          <!-- Tab 1: Mistress of Mayhem + Registry Table -->
          <div class="tab-pane active" id="tab-1">
            <h4>The Mistress of Mayhem</h4>

            <!-- Table Section -->
            <div class="table-section registry">
              <div class="table-img-col">
                <figure class="recorded-portrait">
                  <img
                    src="assets/images/characters/mistress_mayhem_standing.png"
                    alt="The Mistress of Mayhem"
                  />
                </figure>
              </div>

              <div class="table-content-col">
                <h5 class="tab-content-title">Registry of Notable Mis-Adventures</h5>
                <p class="tab-content-tagline">Filed for reference, not encouragement.</p>

                <table>
                  <thead>
                    <tr>
                      <th>Entry</th>
                      <th>Individual (or Party)</th>
                      <th>Ledger Weight</th>
                      <th>Most Recent Failure (Filed)</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>0147</td>
                      <td>Brigg Fenwick</td>
                      <td>2,847</td>
                      <td>Resolved paradox without creating new ones</td>
                    </tr>
                    <tr>
                      <td>0148</td>
                      <td>Seraphine Ironquill</td>
                      <td>2,683</td>
                      <td>Negotiated peace treaty with sentient furniture</td>
                    </tr>
                    <tr>
                      <td>0149</td>
                      <td>Mortimer Blackwood</td>
                      <td>2,541</td>
                      <td>Found lost library; returned all books on time</td>
                    </tr>
                    <tr>
                      <td>0150</td>
                      <td>Three Goblins</td>
                      <td>2,119</td>
                      <td>Successfully prevented escalation by leaving immediately</td>
                    </tr>
                    <tr>
                      <td>0151</td>
                      <td>Pell Understep</td>
                      <td>1,994</td>
                      <td>Identified incorrect lever after it had already been pulled</td>
                    </tr>
                    <tr>
                      <td>0152</td>
                      <td>West Conduit Group</td>
                      <td>1,872</td>
                      <td>Maintained operations despite understanding none of it</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <div class="signature accent">
              She prefers ink that dries slowly. She distrusts summaries. She dislikes patterns that
              explain themselves.
            </div>
          </div>

          <!-- Tab 2: Ledger Entries (Filler) -->
          <div class="tab-pane" id="tab-2">
            <h5 class="tab-content-title">Ledger Entries</h5>
            <p class="tab-content-tagline">
              Additional ledger entries and records will appear here.
            </p>
            <p>This section is reserved for future expansion of the filing system.</p>
          </div>

          <!-- Tab 3: Filed Reports (Filler) -->
          <div class="tab-pane" id="tab-3">
            <h5 class="tab-content-title">Filed Reports</h5>
            <p class="tab-content-tagline">Official filed reports and documentation.</p>
            <p>This section is reserved for future expansion of the filing system.</p>
          </div>

          <!-- Tab 4: Archives (Filler) -->
          <div class="tab-pane" id="tab-4">
            <h5 class="tab-content-title">Pipeworks Status</h5>
            <p class="tab-content-tagline">Is it running?!</p>
            <p><span>Pressure:</span> nominal</p>
            <p><span>Flow:</span> uneven but honest</p>
            <p><span>Vibrations:</span> being monitored</p>
            <p><span>Interpretation:</span> ongoing</p>
          </div>
        </div>
      </section>
    </div>

    <!-- Auth Modal Container (for loading/success states) -->
    <div
      id="dailyAuthModal"
      class="auth-modal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="modalTitle"
    >
      <div class="modal-content">
        <div class="modal-header">
          <h4 id="modalTitle" class="modal-title">Processing Documentation</h4>
        </div>
        <div class="modal-body">
          <div class="spinner-wrapper">
            <div class="spinner"></div>
            <div class="spinner-stamps">
              <span class="stamp">FILED</span>
              <span class="stamp">VERIFIED</span>
              <span class="stamp">APPROVED</span>
            </div>
          </div>
          <p id="modalMessage" class="modal-message">Submitting credentials to the Bureau...</p>
        </div>
      </div>
    </div>

    <!-- Tab Functionality Script -->
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabPanes = document.querySelectorAll('.tab-pane');

        tabButtons.forEach((button) => {
          button.addEventListener('click', () => {
            const tabId = button.getAttribute('data-tab');

            // Remove active class from all buttons and panes
            tabButtons.forEach((btn) => btn.classList.remove('active'));
            tabPanes.forEach((pane) => pane.classList.remove('active'));

            // Add active class to clicked button and corresponding pane
            button.classList.add('active');
            document.getElementById(tabId).classList.add('active');
          });
        });
      });
    </script>

    <!-- Popup Loader Script -->
    <script type="module">
      import {
        openFormModal,
        initializeDailyLoginPopup,
        initializeDailyRegisterPopup,
      } from './js/popup-manager.js';

      document.addEventListener('DOMContentLoaded', () => {
        // Load login popup
        const loginBtn = document.getElementById('openDailyLoginBtn');
        if (loginBtn) {
          loginBtn.addEventListener('click', async () => {
            if (!document.getElementById('dailyLoginModal')) {
              const response = await fetch('popups/daily/daily-login.html');
              const html = await response.text();
              document.body.insertAdjacentHTML('beforeend', html);
              // Initialize event listeners after loading HTML
              initializeDailyLoginPopup();
            }
            openFormModal('dailyLoginModal');
          });
        }

        // Load register popup
        const registerBtn = document.getElementById('openDailyRegisterBtn');
        if (registerBtn) {
          registerBtn.addEventListener('click', async () => {
            if (!document.getElementById('dailyRegisterModal')) {
              const response = await fetch('popups/daily/daily-register.html');
              const html = await response.text();
              document.body.insertAdjacentHTML('beforeend', html);
              // Initialize event listeners after loading HTML
              initializeDailyRegisterPopup();
            }
            openFormModal('dailyRegisterModal');
          });
        }
      });
    </script>
  </body>
</html>
